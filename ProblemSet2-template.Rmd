---
title: "Analysis on key factors affecting life satisfaction"
author: "Woolim Kim, Yena Joo, Guemin Kim"
date: "Oct 19, 2020"
output:
  pdf_document: default
  html_document:
    df_print: paged
---

```{r setup, include=FALSE}
library(dplyr)
library(tidyverse)
data <- read_csv("gss.csv")
```

## Analysis on key factors affecting life satisfaction

# Woolim Kim, Yena Joo, Guemin Kim
# Oct 19, 2020

## Abstract

We use the 2017 General Social Survey(GSS) data to study the response of their _____ to ____. The target population includes all non-institutionalized persons 15 years of age and older, living in the 10 provinces of Canada. The frame population is everyone who is registered combining both landline and cellular with Statistics Canada’s address registers, and the sampled population is whoever was reached via telephone. The target populations were stratified into 27 strata by geographic areas—mostly CMA— and simple random sampling without replacement of records was performed in each stratum.  
We find….  
1. a strong ….  
2. no overall effects in ….  

Together, these results suggest that…….

## Introduction


Here is where you should give insight into the setting and introduce the goal of the analysis. Here you can introduce ideas and basic concepts regarding the study setting and the potential model. Again, this is the introduction, so you should be explaining the importance of the work that is ahead and hopefully build some suspense for the reader. You can also highlight what will be included in the subsequent sections.

**INTRO (1)
In recent periods, COVID-19 crisis has changed many things. Millions of people have lost their jobs, untold numbers of people fear they could lose their incomes any day, and people are having constant worries for their relates health and their own. 

There are many factors that determines people’s satisfaction and well being of their life. It could be people’s health, income, family, religion, or other elements that makes them feel satisfied. Specially, in situation where we are living in full of uncertainty, people are feeling more stressed and those concerns give negative influence on their own’s well being. Under the circumstances we wanted to take a close look on which factors of people’s life has the most impact on people’s satisfaction of their lives.

The data set we chose for this assignment contains responses of the General Social Survey conducted in 2017. The 2017 GSS data are monitoring changes in the living conditions and well being of Canadians over time. The 2017 GSS data includes variety of different variables such as, age, sex, education, feelings life, self rated health, income, etc. With the collected data we can analyze how people’s satisfaction score is dependent and has significant relationship with different factor variables.

The following sections will use statistical methods to build new models and analyze the data. It includes cleaning the data into simpler model, linear regression modeling to find the significance of satisfaction score and predictor variables, comparing and creating graphical visualizations.



## Data
Introduce the data, explain why it was selected. Make sure to comment on important features and highlight any potential drawbacks to the data.

** Guemin  
The data set we chose for this assignment contains responses of the General Social Survey conducted in 2017. The contents of the survey include some characteristics of diverse families in Canada, their socio-economic status, as well as other subjective information such as the respondent's life satisfaction and health conditions. 

Since we want to identify some key factors affecting one's life satisfaction as mentioned previously, the focus of our analysis will be "Health and subjective well-being". 

The reason for choosing the 2017 GSS is because it is the most recent^[As it is stated in the documentation of the GSS, one of the primary objectives of the General Social Survey is to monitor the well being of Canadians over time.
As a result, every survey conducted so far contain the responses related to the questions asking for the respondents' well being, and the 2017 GSS is the most recent survey with such reponses.] survey that includes  the "Health and subjective well being" concept.

Since the original data set contains too many variables that are not neccessary, we are going to clean the data set prior to analysis by removing them.  

```{r include = F, echo = F, warning = F, message = F}
# life satisfaction data with some potential factors
life_satisfaction_data <- data %>% 
  select(caseid, age, sex, feelings_life, self_rated_health, self_rated_mental_health, 
         income_family, average_hours_worked) %>% 
  mutate(self_rated_health = case_when(self_rated_health == "Excellent" ~ 5, 
                                       self_rated_health == "Very good" ~ 4, 
                                       self_rated_health == "Good" ~ 3, 
                                       self_rated_health == "Fair" ~ 2, 
                                       self_rated_health == "Poor" ~1, 
                                       self_rated_health == "Don't know" ~ 0)) %>%
  mutate(self_rated_mental_health = case_when(self_rated_mental_health == "Excellent" ~ 5, 
                                              self_rated_mental_health == "Very good" ~ 4, 
                                              self_rated_mental_health == "Good" ~ 3, 
                                              self_rated_mental_health == "Fair" ~ 2, 
                                              self_rated_mental_health == "Poor" ~1, 
                                              self_rated_mental_health == "Don't know" ~ 0)) %>%
  filter(self_rated_health != 0, self_rated_mental_health != 0, 
         average_hours_worked != "Don't know") %>%
  rename(ID = caseid, satisfaction_score = feelings_life, family_income = income_family) %>%
  mutate(self_rated_total_health = (self_rated_health + self_rated_mental_health)/2) #merged mental health and physical health in to one variable.
  
```

This is what our new data looks like:
```{r echo = F, warning = F, message = F}
head(life_satisfaction_data)
```

Our data contains 8 variables: ID, age, sex, satisfaction_score, self_rated_health, self_rated_mental_health, family_income, and average_hours_worked.  

Detailed descriptions of some variables:  
 * satisfaction_score indicates the life satisfaction score on a scale of 0(very dissatisfied) to 10(very satisfied).  
 * self_rated_health and self_rated_mental health are the physical and mental health ratings, respectively, on a scale of 1(poor) to 5(Excellent) given by the respondent.  
 * average_hours_worked indicates the average number of hours worked per week.  


Since we want to observe how the life satisfaction score is related to potential factors such as health or financial conditions, the response variable of our analysis will be satisfaction_score and the predictors will be the potential factors: self_rated_health, self_rated_mental_health, family_income, and average_hours_worked.
**



## Model

Introduce the selected model here. It is expected that you will use some mathematical notation here. If you do please ensure that all notation is explained. You may also want to discuss any special (hypothetical) cases of your model here, as well as any caveats.  

**  

Now, we are going to fit a multiple linear regression model in order to find linear associations between satisfaction_score and other predictor variables.  

```{r include = F, echo = F, warning = F, message= F}
# General Linear Regression Model
# for satisfaction_score by all predictor variables
satisfaction_lm <- lm(satisfaction_score ~ as.factor(self_rated_health) 
                      + as.factor(self_rated_mental_health) 
                      + family_income 
                      + average_hours_worked, data = life_satisfaction_data)
```

Here is the summary of the multiple linear regression model:  

```{r echo = F, warning = F, message = F}
summary(satisfaction_lm)
```
  
As we can observe from the output, estimated satisfaction_score increases as each of self_rated_health, self_rated_mental_health and family_income increases; however, the slope estimates for average_hours_work are found to be quite inconsistent, because there is a decrease in slope estimates from 0.29608 to 0.23252 in the first two intervals of average_hours_work, but it increases again in the thrid and fourth intervals.  
Furthermore, p-values for average_hours_worked that are much greater than the significance level of 0.05 provide us with more evidence that there are no linear relationship between the average working hours and the life satisfaction score.  
Therefore, the regression model suggests that only the physical health condition, mental health condition and financial condition have positive linear relationships with the life satisfaction score.  

Now that we've found out the response variable has linear relationships with some of the predictor variables, ask yourslef: are the predictor variables equally important in terms of explaning the variability in satisfaction_score?  

The answer is 'No'.  

Although they all have positive linear relationships with the response variable, not all variables may contribute significantly in explaining the variability of the response variable.  

Hence, we would now like to identify the most important predictor variable in this regression model.  

There are two ways we can identify the most important predictor^[One way is to compare the standardized regression coefficients and the other way is to compare the increases in R-squared when each predictor is added to the regression model. For this analysis, specifically, we could not use the first method, because our model contains categorical predictor variable which cannot be standardized.]

The one that we are going to use in this analysis is by comparing the changes in $R^2$ for the last variable added to the model. This is a valid method for identifying which predictor explains the most variability in the response variable, because when a newly added predictor variable is the only difference between the two models, the associated change in $R^2$ will represent the 'goodness-of-fit'.  

To be more specific, we are going to begin with fitting a linear model with only one predictor, and then add one predictor to the model at a time to see how much $R^2$ changes when each variable is added.

Key point in this method is to identify the predictor variable with the largest increase in $R^2$ when it is the last variable added to the model.  

```{r include = F, echo = F, warning = F, message = F}
# Simple Linear Regression Model with predictor self_rated_health
first <- lm(satisfaction_score ~ self_rated_health, data = life_satisfaction_data)
first_R2 <- summary(first)$r.squared

second <- lm(satisfaction_score ~ self_rated_health + self_rated_mental_health, data = life_satisfaction_data)
second_R2 <-summary(second)$r.squared

third <- lm(satisfaction_score ~ self_rated_health + self_rated_mental_health + family_income, data = life_satisfaction_data)
third_R2 <- summary(third)$r.squared
```

This is the table with $R^2$ values in each model, and the change in $R^2$ as more variables are added:  
```{r echo = F, warning = F, message = F}
tibble(R_squared = c(first_R2, second_R2, third_R2), Change = c(first_R2, second_R2 - first_R2, third_R2 - second_R2))
```

As it is shown in the table, there is a greatest increase in $R^2$ when the second predictor, self_rated_mental_health is added to the model. This increase is quite close the $R^2$ of our initial simple linear regression model with predictor self_rated_health.  

Hence, the result suggests that both physical and mental health are significant predictors, however, mental health is the most important predictor in explaining the variability of the life satisfaction score.




```{r}

life_satisfaction_data %>%
  ggplot(aes(x = as.factor(self_rated_total_health), y = (satisfaction_score))) + geom_boxplot() +
  ggtitle("How Mental and Physical Health Affects People's Satisfaction") +
  ylab("Satisfaction score") +
  xlab("Self rated total health")

```

## Results

Here you will include all results. This includes descriptive statistics, graphs, figures, tables, and model results. Please ensure that everything is well formatted and in a report style. You must also provide an explanation of the results in this section. You can overflow to an Appendix if needed. 

Please ensure that everything is well labelled. So if you have multiple histograms and plots, calling them Figure 1, 2, 3, etc. and referencing them as Figure 1, Figure 2, etc. in your report will be expected. The reader should not get lost in a sea of information. Make sure to have the results be clean, well formatted and digestible.

## Discussion

Here you will discuss conclusions drawn from the results and comment on how it relates to the original goal of the study (which was specified in the Introduction).

# Weaknesses

Here we discuss weaknesses of the study, data, analysis, etc. You can also discuss areas for improvement.

# Next Steps

Here you discuss subsequent work to be done after this report. This can include next steps in terms of statistical analysis (perhaps there is a more efficient algorithm available, or perhaps there is a caveat in the data that would allow for some new technique). Future steps should also be specified in terms of the study setting (eg. including a follow-up survey on something, or a subsequent study that would complement the conclusions of your report).


## References

1. GSS Data: 

2. Data Cleaning Code:




